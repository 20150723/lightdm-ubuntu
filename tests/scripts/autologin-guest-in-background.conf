#
# Check automatically logs in default user while keeping a greeter up
#

[LightDM]
minimum-display-number=50

[SeatDefaults]
autologin-guest=true
autologin-in-background=true

#?RUNNER DAEMON-START

# The following is a gross expansion of two simultaneous sequences.  One day,
# when we can specify such things in tests, they should look like the
# following:
# 
# ?XSERVER :50 START
# ?XSERVER :50 INDICATE-READY
#
# Sequence 1:
# ?XSERVER :50 ACCEPT-CONNECT
# ?GREETER :50 START
# ?XSERVER :50 ACCEPT-CONNECT
# ?GREETER :50 CONNECT-XSERVER
# ?GREETER :50 CONNECT-TO-DAEMON
# ?GREETER :50 CONNECTED-TO-DAEMON
# GREETER/XSERVER TERMINATE
# 
# Sequence 2
# ?XSERVER :51 START
# ?XSERVER :51 INDICATE-READY
# ?XSERVER :51 ACCEPT-CONNECT
# ?GUEST-ACCOUNT ADD USERNAME=guest-.*
# ?SESSION :51 START USER=guest-.*
# ?XSERVER :51 ACCEPT-CONNECT
# ?SESSION :51 CONNECT-XSERVER
# SESSION/XSERVER TERMINATE

#?XSERVER :50 START
#?XSERVER :50 INDICATE-READY

#?(XSERVER :50 ACCEPT-CONNECT|GREETER :50 START|XSERVER :50 ACCEPT-CONNECT|GREETER :50 CONNECT-XSERVER|GREETER :50 CONNECT-TO-DAEMON|GREETER :50 CONNECTED-TO-DAEMON|XSERVER :51 START|XSERVER :51 INDICATE-READY|XSERVER :51 ACCEPT-CONNECT|GUEST-ACCOUNT ADD USERNAME=guest-.*|SESSION :51 START USER=guest-.*|XSERVER :51 ACCEPT-CONNECT|SESSION :51 CONNECT-XSERVER)
#?(XSERVER :50 ACCEPT-CONNECT|GREETER :50 START|XSERVER :50 ACCEPT-CONNECT|GREETER :50 CONNECT-XSERVER|GREETER :50 CONNECT-TO-DAEMON|GREETER :50 CONNECTED-TO-DAEMON|XSERVER :51 START|XSERVER :51 INDICATE-READY|XSERVER :51 ACCEPT-CONNECT|GUEST-ACCOUNT ADD USERNAME=guest-.*|SESSION :51 START USER=guest-.*|XSERVER :51 ACCEPT-CONNECT|SESSION :51 CONNECT-XSERVER)
#?(XSERVER :50 ACCEPT-CONNECT|GREETER :50 START|XSERVER :50 ACCEPT-CONNECT|GREETER :50 CONNECT-XSERVER|GREETER :50 CONNECT-TO-DAEMON|GREETER :50 CONNECTED-TO-DAEMON|XSERVER :51 START|XSERVER :51 INDICATE-READY|XSERVER :51 ACCEPT-CONNECT|GUEST-ACCOUNT ADD USERNAME=guest-.*|SESSION :51 START USER=guest-.*|XSERVER :51 ACCEPT-CONNECT|SESSION :51 CONNECT-XSERVER)
#?(XSERVER :50 ACCEPT-CONNECT|GREETER :50 START|XSERVER :50 ACCEPT-CONNECT|GREETER :50 CONNECT-XSERVER|GREETER :50 CONNECT-TO-DAEMON|GREETER :50 CONNECTED-TO-DAEMON|XSERVER :51 START|XSERVER :51 INDICATE-READY|XSERVER :51 ACCEPT-CONNECT|GUEST-ACCOUNT ADD USERNAME=guest-.*|SESSION :51 START USER=guest-.*|XSERVER :51 ACCEPT-CONNECT|SESSION :51 CONNECT-XSERVER)
#?(XSERVER :50 ACCEPT-CONNECT|GREETER :50 START|XSERVER :50 ACCEPT-CONNECT|GREETER :50 CONNECT-XSERVER|GREETER :50 CONNECT-TO-DAEMON|GREETER :50 CONNECTED-TO-DAEMON|XSERVER :51 START|XSERVER :51 INDICATE-READY|XSERVER :51 ACCEPT-CONNECT|GUEST-ACCOUNT ADD USERNAME=guest-.*|SESSION :51 START USER=guest-.*|XSERVER :51 ACCEPT-CONNECT|SESSION :51 CONNECT-XSERVER)
#?(XSERVER :50 ACCEPT-CONNECT|GREETER :50 START|XSERVER :50 ACCEPT-CONNECT|GREETER :50 CONNECT-XSERVER|GREETER :50 CONNECT-TO-DAEMON|GREETER :50 CONNECTED-TO-DAEMON|XSERVER :51 START|XSERVER :51 INDICATE-READY|XSERVER :51 ACCEPT-CONNECT|GUEST-ACCOUNT ADD USERNAME=guest-.*|SESSION :51 START USER=guest-.*|XSERVER :51 ACCEPT-CONNECT|SESSION :51 CONNECT-XSERVER)
#?(XSERVER :50 ACCEPT-CONNECT|GREETER :50 START|XSERVER :50 ACCEPT-CONNECT|GREETER :50 CONNECT-XSERVER|GREETER :50 CONNECT-TO-DAEMON|GREETER :50 CONNECTED-TO-DAEMON|XSERVER :51 START|XSERVER :51 INDICATE-READY|XSERVER :51 ACCEPT-CONNECT|GUEST-ACCOUNT ADD USERNAME=guest-.*|SESSION :51 START USER=guest-.*|XSERVER :51 ACCEPT-CONNECT|SESSION :51 CONNECT-XSERVER)
#?(XSERVER :50 ACCEPT-CONNECT|GREETER :50 START|XSERVER :50 ACCEPT-CONNECT|GREETER :50 CONNECT-XSERVER|GREETER :50 CONNECT-TO-DAEMON|GREETER :50 CONNECTED-TO-DAEMON|XSERVER :51 START|XSERVER :51 INDICATE-READY|XSERVER :51 ACCEPT-CONNECT|GUEST-ACCOUNT ADD USERNAME=guest-.*|SESSION :51 START USER=guest-.*|XSERVER :51 ACCEPT-CONNECT|SESSION :51 CONNECT-XSERVER)
#?(XSERVER :50 ACCEPT-CONNECT|GREETER :50 START|XSERVER :50 ACCEPT-CONNECT|GREETER :50 CONNECT-XSERVER|GREETER :50 CONNECT-TO-DAEMON|GREETER :50 CONNECTED-TO-DAEMON|XSERVER :51 START|XSERVER :51 INDICATE-READY|XSERVER :51 ACCEPT-CONNECT|GUEST-ACCOUNT ADD USERNAME=guest-.*|SESSION :51 START USER=guest-.*|XSERVER :51 ACCEPT-CONNECT|SESSION :51 CONNECT-XSERVER)
#?(XSERVER :50 ACCEPT-CONNECT|GREETER :50 START|XSERVER :50 ACCEPT-CONNECT|GREETER :50 CONNECT-XSERVER|GREETER :50 CONNECT-TO-DAEMON|GREETER :50 CONNECTED-TO-DAEMON|XSERVER :51 START|XSERVER :51 INDICATE-READY|XSERVER :51 ACCEPT-CONNECT|GUEST-ACCOUNT ADD USERNAME=guest-.*|SESSION :51 START USER=guest-.*|XSERVER :51 ACCEPT-CONNECT|SESSION :51 CONNECT-XSERVER)
#?(XSERVER :50 ACCEPT-CONNECT|GREETER :50 START|XSERVER :50 ACCEPT-CONNECT|GREETER :50 CONNECT-XSERVER|GREETER :50 CONNECT-TO-DAEMON|GREETER :50 CONNECTED-TO-DAEMON|XSERVER :51 START|XSERVER :51 INDICATE-READY|XSERVER :51 ACCEPT-CONNECT|GUEST-ACCOUNT ADD USERNAME=guest-.*|SESSION :51 START USER=guest-.*|XSERVER :51 ACCEPT-CONNECT|SESSION :51 CONNECT-XSERVER)
#?(XSERVER :50 ACCEPT-CONNECT|GREETER :50 START|XSERVER :50 ACCEPT-CONNECT|GREETER :50 CONNECT-XSERVER|GREETER :50 CONNECT-TO-DAEMON|GREETER :50 CONNECTED-TO-DAEMON|XSERVER :51 START|XSERVER :51 INDICATE-READY|XSERVER :51 ACCEPT-CONNECT|GUEST-ACCOUNT ADD USERNAME=guest-.*|SESSION :51 START USER=guest-.*|XSERVER :51 ACCEPT-CONNECT|SESSION :51 CONNECT-XSERVER)

# Cleanup
#?*STOP-DAEMON
# Don't know what order they will terminate
#?(GREETER :50 TERMINATE SIGNAL=15|XSERVER :50 TERMINATE SIGNAL=15|SESSION :51 TERMINATE SIGNAL=15|XSERVER :51 TERMINATE SIGNAL=15|GUEST-ACCOUNT REMOVE USERNAME=guest-.*)
#?(GREETER :50 TERMINATE SIGNAL=15|XSERVER :50 TERMINATE SIGNAL=15|SESSION :51 TERMINATE SIGNAL=15|XSERVER :51 TERMINATE SIGNAL=15|GUEST-ACCOUNT REMOVE USERNAME=guest-.*)
#?(GREETER :50 TERMINATE SIGNAL=15|XSERVER :50 TERMINATE SIGNAL=15|SESSION :51 TERMINATE SIGNAL=15|XSERVER :51 TERMINATE SIGNAL=15|GUEST-ACCOUNT REMOVE USERNAME=guest-.*)
#?(GREETER :50 TERMINATE SIGNAL=15|XSERVER :50 TERMINATE SIGNAL=15|SESSION :51 TERMINATE SIGNAL=15|XSERVER :51 TERMINATE SIGNAL=15|GUEST-ACCOUNT REMOVE USERNAME=guest-.*)
#?(GREETER :50 TERMINATE SIGNAL=15|XSERVER :50 TERMINATE SIGNAL=15|SESSION :51 TERMINATE SIGNAL=15|XSERVER :51 TERMINATE SIGNAL=15|GUEST-ACCOUNT REMOVE USERNAME=guest-.*)
#?RUNNER DAEMON-EXIT STATUS=0
